% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_sty.R
\name{get_sty}
\alias{get_sty}
\title{Calculate and Visualize Phosphorylation Site (S/T/Y) Distribution}
\usage{
get_sty(
  data,
  plot = c("no", "count", "percentage"),
  sample_name,
  group,
  ptm_site_prob_col,
  ptm_site_prob_val = 0.75,
  ptm_site_amino_acid,
  selected_group = NULL
)
}
\arguments{
\item{data}{A data frame containing phosphoproteomics data. This data frame
is expected to have columns for sample names, phosphorylation site
probabilities, amino acid type of the phosphorylation site, and a grouping
variable.}

\item{plot}{A character string specifying the type of plot to generate.
\itemize{
  \item "no": No plot is generated; only the summary table is returned.
  \item "count": Generates bar plots showing the absolute counts of S, T, and Y
    phosphosites for each group, faceted by amino acid type.
  \item "percentage": Generates bar plots showing the percentage distribution
    of S, T, and Y phosphosites within each group, faceted by amino acid type.
}}

\item{sample_name}{[`data-masking`][rlang::args_data_masking]> The unquoted name
of the column in `data` that contains unique sample identifiers.
e.g., `SampleID`.}

\item{group}{<[`data-masking`][rlang::args_data_masking]> The unquoted name of
the column in `data` that defines the experimental groups (e.g., "control", "treat").}

\item{ptm_site_prob_col}{<[`data-masking`][rlang::args_data_masking]> The unquoted
name of the column in `data` that contains phosphorylation site probabilities
(e.g., "Localization_Probabilities").}

\item{ptm_site_prob_val}{Numeric, a cutoff value for `ptm_site_prob_col`. Only
sites with a probability greater than or equal to this value will be included
in the analysis. Default is `0.75`.}

\item{ptm_site_amino_acid}{<[`data-masking`][rlang::args_data_masking]> The unquoted
name of the column in `data` that contains the amino acid type of the
phosphorylation site (expected to be "S", "T", or "Y").
e.g., `Amino_Acid`.}

\item{selected_group}{A character vector specifying which groups from the `group`
column should be included in the plots. If omitted or `NULL`, all groups will be plotted.
This parameter is ignored if `plot = "no"`.}
}
\value{
#' If `plot = "no"`, returns a `data.frame` (tibble) summarizing the counts and
percentages of S, T, Y phosphosites per sample.
If `plot = "count"` or `plot = "percentage"`, returns a `list` containing:
\itemize{
  \item `summary_table`: The `data.frame` of S/T/Y counts and percentages.
  \item `plot`: A `ggplot` object of the generated bar plot.
}
}
\description{
This function calculates the absolute counts and percentages of phosphorylation
sites (Serine (S), Threonine (T), Tyrosine (Y)) for each sample, based on a
user-defined phosphorylation site probability cutoff. It can then optionally
generate bar plots to visualize these counts or percentages across different
sample groups.
}
\examples{
# Create data for demonstration
set.seed(123)
phospho_data <- data.frame(
  SampleID = rep(c("S1_ctrl", "S2_ctrl", "S3_treat", "S4_treat"), each = 25),
  Group = rep(c("Control", "Control", "Treatment", "Treatment"), each = 25),
  Protein = paste0("Prot", 1:100),
  Localization_Probabilities = runif(100, 0.5, 0.99),
  Amino_Acid = sample(c("S", "T", "Y"), 100, replace = TRUE, prob = c(0.7, 0.2, 0.1))
)

# Case 1: Calculate S/T/Y distribution and return data only
sty_counts_df <- get_sty(
  data = phospho_data,
  plot = "no",
  sample_name = SampleID,
  group = Group,
  ptm_site_prob_col = Localization_Probabilities,
  ptm_site_prob_val = 0.75,
  ptm_site_amino_acid = Amino_Acid
)
print(sty_counts_df)

# Case 2: Calculate S/T/Y distribution and generate count plots
# Define selected groups for plotting
selected_groups_for_plot <- c("Control", "Treatment")

sty_counts_plot <- get_sty(
  data = phospho_data,
  plot = "count",
  sample_name = SampleID,
  group = Group,
  ptm_site_prob_col = Localization_Probabilities,
  ptm_site_prob_val = 0.75,
  ptm_site_amino_acid = Amino_Acid,
  selected_group = selected_groups_for_plot
)
print(sty_counts_plot$summary_table)
sty_counts_plot$plot # Display the count plot

# Case 3: Calculate S/T/Y distribution and generate percentage plots
sty_percentage_plot <- get_sty(
  data = phospho_data,
  plot = "percentage",
  sample_name = SampleID,
  group = Group,
  ptm_site_prob_col = Localization_Probabilities,
  ptm_site_prob_val = 0.75,
  ptm_site_amino_acid = Amino_Acid,
  selected_group = selected_groups_for_plot
)
print(sty_percentage_plot$summary_table)
sty_percentage_plot$plot # Display the percentage plot

}
